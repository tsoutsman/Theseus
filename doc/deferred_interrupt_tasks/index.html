<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Abstractions for deferred interrupt tasks, a companion to regular interrupt handlers."><meta name="keywords" content="rust, rustlang, rust-lang, deferred_interrupt_tasks"><title>deferred_interrupt_tasks - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" href="../normalize.css"><link rel="stylesheet" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" href="../ayu.css" disabled><link rel="stylesheet" href="../dark.css" disabled><link rel="stylesheet" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script defer src="../crates.js"></script><script defer src="../main.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../deferred_interrupt_tasks/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div></a><h2></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../deferred_interrupt_tasks/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div></a><h2 class="location"><a href="#">Crate deferred_interrupt_tasks</a></h2><div class="sidebar-elems"><ul class="block"><li class="version">Version 0.1.0</li><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#enums">Enums</a></li><li><a href="#functions">Functions</a></li><li><a href="#types">Type Definitions</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../wheel.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn">Crate <a class="mod" href="#">deferred_interrupt_tasks</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../src/deferred_interrupt_tasks/lib.rs.html#1-180">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Abstractions for deferred interrupt tasks, a companion to regular interrupt handlers.</p>
<p>Deferred interrupt tasks are similar to the concept of “top half” and “bottom half”
interrupt handlers in other OSes, in which the top half is the short, latency-sensitive
function that runs immediately when the interrupt request is serviced,
while the bottom half is the more complex function that runs in a deferred manner
to handle longer operations.
Other terminology is often used, including “first-level” and
“second-level” interrupt handlers, or “hard” and “soft” interrupt handlers.</p>
<p>That being said, this implementation of deferred interrupt tasks
differs from both tasklets and workqueues in Linux.
We also do not use the “top half” or “bottom half” terminology
because it is confusing and difficult to remember which is which.
Instead, we refer to the first latency-sensitive part as the
<em>interrupt handler</em> and the second later part as the <em>deferred task</em>.
The “interrupt handler” runs immediately (in a synchronous fashion) 
when the interrupt occurs, while the deferred task runs asynchronously
at some time in the future, ideally as soon as possible.</p>
<p>The general idea is that an interrupt handler should be short
and do the minimum amount of work possible in order to keep 
the system responsive, because all (or most) other interrupts
are typically disabled while the interrupt handler executes to completion.
Thus, most of the work should be deferred until later, such that the
interrupt handler itself only does a couple of quick things:</p>
<ul>
<li>Notifies the deferred task that work is ready to be done,
optionally providing details about what work it needs to do,</li>
<li>Acknowledges the interrupt such that the hardware knows it was handled.</li>
</ul>
<p>The deferred task is tied directly to a single interrupt handler in a 1-to-1 manner
at the time of creation, which occurs in <a href="fn.register_interrupt_handler.html" title="register_interrupt_handler()"><code>register_interrupt_handler()</code></a>.
Therefore, it is both efficient and easy to use. 
In the simplest of cases, such as a serial port device, the interrupt handler
only needs to mark the deferred task as unblocked (runnable)
and then acknowledge the interrupt. 
No other data exchange is needed between the interrupt handler and the 
deferred task.
For more complicated cases, the interrupt handler may need to do a minimal
amount of bookkeeping tasks (such as advancing a ringbuffer index)
and potentially send some information about what the deferred task should do.
It is typically best to use a lock-free queue or an interrupt-safe mutex
to share such information between the interrupt handler and deferred task.</p>
</div></details><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.InterruptRegistrationError.html" title="deferred_interrupt_tasks::InterruptRegistrationError enum">InterruptRegistrationError</a></div><div class="item-right docblock-short">The errors that may occur in <a href="fn.register_interrupt_handler.html" title="register_interrupt_handler()"><code>register_interrupt_handler()</code></a>.</div></div></div><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.register_interrupt_handler.html" title="deferred_interrupt_tasks::register_interrupt_handler fn">register_interrupt_handler</a></div><div class="item-right docblock-short">Registers an interrupt handler and spawns a companion “deferred task” 
that asynchronously handles the longer-running operations related to that interrupt.</div></div></div><h2 id="types" class="small-section-header"><a href="#types">Type Definitions</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="type" href="type.InterruptHandlerFunction.html" title="deferred_interrupt_tasks::InterruptHandlerFunction type">InterruptHandlerFunction</a></div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="deferred_interrupt_tasks" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.67.0-nightly (edf018221 2022-11-02)" ></div></body></html>