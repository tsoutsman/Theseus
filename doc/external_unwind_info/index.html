<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Registers and stores unwind information from external components."><meta name="keywords" content="rust, rustlang, rust-lang, external_unwind_info"><title>external_unwind_info - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" href="../normalize.css"><link rel="stylesheet" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" href="../ayu.css" disabled><link rel="stylesheet" href="../dark.css" disabled><link rel="stylesheet" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script defer src="../crates.js"></script><script defer src="../main.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../external_unwind_info/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div></a><h2></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../external_unwind_info/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div></a><h2 class="location"><a href="#">Crate external_unwind_info</a></h2><div class="sidebar-elems"><ul class="block"><li class="version">Version 0.1.0</li><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#structs">Structs</a></li><li><a href="#functions">Functions</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../wheel.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn">Crate <a class="mod" href="#">external_unwind_info</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../src/external_unwind_info/lib.rs.html#1-117">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Registers and stores unwind information from external components.</p>
<p>Typically, Theseus maintains metadata about all crates loaded and linked into system.
Unwind info is part of this (the <code>.eh_frame</code> section data).</p>
<p>However, for other components compiled outside of Theseus and beyond it’s knowledge,
we don’t necessarily have control over or access to those components’ section structure
and miscellaneous internal information.
Nevertheless, we still want to be able to handle their resource management properly
by unwinding through their stack frames and running cleanup handlers as needed.</p>
<p>Hence, this crate allows those external components to register their own 
unwind information as needed.
Currently, we use this crate to support <a href="https://docs.rs/wasmtime-jit/latest/wasmtime_jit/"><code>wasmtime-jit</code></a>, which needs to 
<a href="https://github.com/bytecodealliance/wasmtime/blob/7cf5f058303d2ee8c42df658d4ca608771a8561d/crates/jit/src/code_memory.rs#L185">register unwinding information</a> for JIT-compiled native code built from WASM binaries
and then deregister it when those JIT-ted modules are destroyed.</p>
<p>The API here is loosely similar to <code>libunwind</code>’s two-part API: 
<code>__register_frame()</code> and <code>__deregister_frame()</code>.
Because it must accept raw pointers to sections, all APIs are inherently unsafe.</p>
<h3 id="future-todos"><a href="#future-todos">Future TODOs</a></h3>
<p>Currently, this crate unsafely assumes that the third party component that registers its unwind info
will ensure that unwind info is valid for the full duration of it being registered.</p>
<p>In the future, ideally we would redesign this crate to offer a safer API
that obtains shared ownership
However, that would of course require modifying the dependent crates and redesigning them
to utilize this safer API.</p>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.ExternalUnwindInfo.html" title="external_unwind_info::ExternalUnwindInfo struct">ExternalUnwindInfo</a></div><div class="item-right docblock-short">Unwinding information for an external (non-Theseus) component.</div></div></div><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.deregister_unwind_info.html" title="external_unwind_info::deregister_unwind_info fn">deregister_unwind_info</a><sup title="unsafe function">⚠</sup></div><div class="item-right docblock-short">Remove a previously-registered section of external unwinding information.</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.get_unwind_info.html" title="external_unwind_info::get_unwind_info fn">get_unwind_info</a></div><div class="item-right docblock-short">Returns the registered external unwind information that covers
the given address in its text section.</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.register_unwind_info.html" title="external_unwind_info::register_unwind_info fn">register_unwind_info</a><sup title="unsafe function">⚠</sup></div><div class="item-right docblock-short">Register  a new section of external unwinding information.</div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="external_unwind_info" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.67.0-nightly (edf018221 2022-11-02)" ></div></body></html>