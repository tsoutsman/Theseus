<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Provides an allocator for physical memory frames. The minimum unit of allocation is a single frame. "><title>frame_allocator - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-9ee3a5e31a2afa3e.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="frame_allocator" data-themes="" data-resource-suffix="" data-rustdoc-version="1.75.0-nightly (aa1a71e9e 2023-10-26)" data-channel="nightly" data-search-js="search-8fbf244ebcf71464.js" data-settings-js="settings-74424d7eec62a23e.js" ><script src="../static.files/storage-fec3eaa3851e447d.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-5f34af1a0ee6bacd.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-5d8b3c7633ad77ba.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../frame_allocator/index.html">frame_allocator</a><span class="version">0.1.0</span></h2></div><div class="sidebar-elems"><ul class="block">
            <li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#functions">Functions</a></li><li><a href="#types">Type Aliases</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">frame_allocator</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../src/frame_allocator/lib.rs.html#1-1388">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Provides an allocator for physical memory frames.
The minimum unit of allocation is a single frame. </p>
<p>This is currently a modified and more complex version of the <code>page_allocator</code> crate.
TODO: extract the common code and create a generic allocator that can be specialized to allocate pages or frames.</p>
<p>This also supports early allocation of frames before heap allocation is available, 
and does so behind the scenes using the same single interface. 
Early pre-heap allocations are limited to tracking a small number of available chunks (currently 32).</p>
<p>Once heap allocation is available, it uses a dynamically-allocated list of frame chunks to track allocations.</p>
<p>The core allocation function is <a href="fn.allocate_frames_deferred.html"><code>allocate_frames_deferred()</code></a>, 
but there are several convenience functions that offer simpler interfaces for general usage. </p>
<h2 id="notes-and-missing-features"><a href="#notes-and-missing-features">Notes and Missing Features</a></h2>
<p>This allocator only makes one attempt to merge deallocated frames into existing
free chunks for de-fragmentation. It does not iteratively merge adjacent chunks in order to
maximally combine separate chunks into the biggest single chunk.
Instead, free chunks are merged only when they are dropped or when needed to fulfill a specific request.</p>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.AllocatedFrame.html" title="struct frame_allocator::AllocatedFrame">AllocatedFrame</a></div><div class="desc docblock-short">A reference to a single frame within a range of <code>AllocatedFrames</code>.</div></li><li><div class="item-name"><a class="struct" href="struct.AllocatedFramesIter.html" title="struct frame_allocator::AllocatedFramesIter">AllocatedFramesIter</a></div><div class="desc docblock-short">An iterator over each <a href="struct.AllocatedFrame.html" title="struct frame_allocator::AllocatedFrame"><code>AllocatedFrame</code></a> in a range of <a href="type.AllocatedFrames.html" title="type frame_allocator::AllocatedFrames"><code>AllocatedFrames</code></a>.</div></li><li><div class="item-name"><a class="struct" href="struct.DeferredAllocAction.html" title="struct frame_allocator::DeferredAllocAction">DeferredAllocAction</a></div><div class="desc docblock-short">A series of pending actions related to frame allocator bookkeeping,
which may result in heap allocation. </div></li><li><div class="item-name"><a class="struct" href="struct.Frames.html" title="struct frame_allocator::Frames">Frames</a></div><div class="desc docblock-short">A range of contiguous frames in physical memory.</div></li><li><div class="item-name"><a class="struct" href="struct.PhysicalMemoryRegion.html" title="struct frame_allocator::PhysicalMemoryRegion">PhysicalMemoryRegion</a></div><div class="desc docblock-short"><code>PhysicalMemoryRegion</code> represents a range of contiguous frames in physical memory for bookkeeping purposes.
It does not give access to the underlying frames.</div></li><li><div class="item-name"><a class="struct" href="struct.SplitFrames.html" title="struct frame_allocator::SplitFrames">SplitFrames</a></div><div class="desc docblock-short">The result of splitting a <code>Frames</code> object into multiple smaller <code>Frames</code> objects.</div></li></ul><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.FramesIteratorRequest.html" title="enum frame_allocator::FramesIteratorRequest">FramesIteratorRequest</a></div><div class="desc docblock-short">An enum that must be returned by the function passed into <a href="fn.inspect_then_allocate_free_frames.html" title="fn frame_allocator::inspect_then_allocate_free_frames"><code>inspect_then_allocate_free_frames()</code></a>
in order to define the post-iteration behavior.</div></li><li><div class="item-name"><a class="enum" href="enum.MemoryRegionType.html" title="enum frame_allocator::MemoryRegionType">MemoryRegionType</a></div><div class="desc docblock-short">Types of physical memory. See each variant’s documentation.</div></li></ul><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.allocate_frames.html" title="fn frame_allocator::allocate_frames">allocate_frames</a></div><div class="desc docblock-short">Allocates the given number of frames with no constraints on the starting physical address.</div></li><li><div class="item-name"><a class="fn" href="fn.allocate_frames_at.html" title="fn frame_allocator::allocate_frames_at">allocate_frames_at</a></div><div class="desc docblock-short">Allocates the given number of frames starting at (inclusive of) the frame containing the given <code>PhysicalAddress</code>.</div></li><li><div class="item-name"><a class="fn" href="fn.allocate_frames_by_bytes.html" title="fn frame_allocator::allocate_frames_by_bytes">allocate_frames_by_bytes</a></div><div class="desc docblock-short">Allocates frames with no constraints on the starting physical address, 
with a size given by the number of bytes. </div></li><li><div class="item-name"><a class="fn" href="fn.allocate_frames_by_bytes_at.html" title="fn frame_allocator::allocate_frames_by_bytes_at">allocate_frames_by_bytes_at</a></div><div class="desc docblock-short">Allocates frames starting at the given <code>PhysicalAddress</code> with a size given in number of bytes. </div></li><li><div class="item-name"><a class="fn" href="fn.allocate_frames_by_bytes_deferred.html" title="fn frame_allocator::allocate_frames_by_bytes_deferred">allocate_frames_by_bytes_deferred</a></div><div class="desc docblock-short">Similar to <a href="fn.allocate_frames_deferred.html"><code>allocated_frames_deferred()</code></a>,
but accepts a size value for the allocated frames in number of bytes instead of number of frames. </div></li><li><div class="item-name"><a class="fn" href="fn.allocate_frames_deferred.html" title="fn frame_allocator::allocate_frames_deferred">allocate_frames_deferred</a></div><div class="desc docblock-short">The core frame allocation routine that allocates the given number of physical frames,
optionally at the requested starting <code>PhysicalAddress</code>.</div></li><li><div class="item-name"><a class="fn" href="fn.init.html" title="fn frame_allocator::init">init</a></div><div class="desc docblock-short">Initialize the frame allocator with the given list of available and reserved physical memory regions.</div></li><li><div class="item-name"><a class="fn" href="fn.inspect_then_allocate_free_frames.html" title="fn frame_allocator::inspect_then_allocate_free_frames">inspect_then_allocate_free_frames</a></div><div class="desc docblock-short">Iterates over all free frames and invokes the given <code>func</code> on each one
in order to determine what to do with those frames.</div></li></ul><h2 id="types" class="small-section-header"><a href="#types">Type Aliases</a></h2><ul class="item-table"><li><div class="item-name"><a class="type" href="type.AllocatedFrames.html" title="type frame_allocator::AllocatedFrames">AllocatedFrames</a></div><div class="desc docblock-short">A type alias for <code>Frames</code> in the <code>Allocated</code> state.</div></li><li><div class="item-name"><a class="type" href="type.FreeFrames.html" title="type frame_allocator::FreeFrames">FreeFrames</a></div><div class="desc docblock-short">A type alias for <code>Frames</code> in the <code>Free</code> state, which only suppports 4K pages.</div></li><li><div class="item-name"><a class="type" href="type.MappedFrames.html" title="type frame_allocator::MappedFrames">MappedFrames</a></div><div class="desc docblock-short">A type alias for <code>Frames</code> in the <code>Mapped</code> state.</div></li><li><div class="item-name"><a class="type" href="type.UnmappedFrames.html" title="type frame_allocator::UnmappedFrames">UnmappedFrames</a></div><div class="desc docblock-short">A type alias for <code>Frames</code> in the <code>Unmapped</code> state.</div></li></ul></section></div></main></body></html>